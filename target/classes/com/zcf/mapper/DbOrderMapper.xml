<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zcf.mapper.DbOrderMapper">


    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.zcf.pojo.DbOrder">
        <id column="o_id" property="oId" />
        <result column="o_strolley_table" property="oStrolleyTable" />
        <result column="o_subtotal" property="oSubtotal" />
        <result column="o_service_charge" property="oServiceCharge" />
        <result column="o_discounts" property="oDiscounts" />
        <result column="o_discounts_price" property="oDiscountsPrice" />
        <result column="o_discounts_remark" property="oDiscountsRemark" />
        <result column="o_state" property="oState" />
        <result column="o_total" property="oTotal" />
        <result column="o_time" property="oTime" />
        <result column="order_to_user" property="orderToUser" />
        <result column="order_to_shop" property="orderToShop" />
        <result column="o_shop_name" property="oShopName" />
        <result column="o_shop_ename" property="oShopEname" />
    </resultMap>

    <!-- 通用查询结果列 -->
    <sql id="Base_Column_List">
        o_id, o_strolley_table, o_subtotal, o_service_charge, o_discounts, o_discounts_price, o_discounts_remark, o_state, o_total, o_time, order_to_user, order_to_shop, o_shop_name, o_shop_ename
    </sql>
<select id="getone" resultType="java.util.Map">
SELECT
	f.*,o.*,DATE_FORMAT(o.o_time,'%Y-%m-%d %H:%i:%s')   otime
FROM
	db_food f
LEFT JOIN db_order_food of ON of.of_foodid = f.f_id
LEFT JOIN db_order o ON o.o_id = of.of_orderid
WHERE
	o.o_id =#{oid}
</select>
<select id="getbyuid" resultType="java.util.Map">
SELECT
	f.*,o.*,DATE_FORMAT(o.o_time,'%Y-%m-%d %H:%i:%s')   otime
FROM
	db_food f
LEFT JOIN db_order_food of ON of.of_foodid = f.f_id
LEFT JOIN db_order o ON o.o_id = of.of_orderid
WHERE
	o.order_to_user=#{uid}
</select>
<select id="getbysid" resultType="java.util.Map">
SELECT
	f.*,o.*,DATE_FORMAT(o.o_time,'%Y-%m-%d %H:%i:%s')   otime
FROM
	db_food f
LEFT JOIN db_order_food of ON of.of_foodid = f.f_id
LEFT JOIN db_order o ON o.o_id = of.of_orderid
WHERE
	o.order_to_shop=#{sid}
</select>

<select id="ordercount" resultType="java.lang.Integer">

select count(*) from db_order where to_days(o_time) = to_days(now());


</select>
</mapper>
