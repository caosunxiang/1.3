<!DOCTYPE html>
<html>

<head>
<meta charset="utf-8">
<meta name="viewport"
	content="width=device-width, initial-scale=1, maximum-scale=1">
<title>修改用户</title>
<link rel="stylesheet" href="layui/css/layui.css">
<link rel="stylesheet" href="static/css/style.css">
<link rel="stylesheet" href="layui/css/layuibtn.css">
</head>
<style>
.roomType {
	display: block !important;
	width: 100%;
	border-color: #D2D2D2 !important;
	height: 38px;
	line-height: 1.3;
	border-width: 1px;
	border-style: solid;
	background-color: #fff;
	border-radius: 2px;
	padding-left: 10px;
}
</style>

<body>
	<div class="container">
		<fieldset class="layui-elem-field layui-field-title"
			style="margin-top: 20px;">
			<legend>修改商铺</legend>
		</fieldset>

		<form class="layui-form" action="" name="c">
			<div class="layui-form-item">
				<label class="layui-form-label">商铺名</label>
				<div class="layui-input-block">
					<input type="text" name="name" lay-verify="title" id="name"
						autocomplete="off" placeholder="请输入商铺名"
						class="layui-input nickname">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">英文名</label>
				<div class="layui-input-block">
					<input type="text" name="ename" lay-verify="title" id="ename"
						autocomplete="off" placeholder="请输入英文名"
						class="layui-input nickname">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">手机号</label>
				<div class="layui-input-block">
					<input type="text" name="phone" lay-verify="title" id="phone"
						autocomplete="off" placeholder="请输入手机号" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">经度</label>
				<div class="layui-input-block">
					<input type="text" name="longitude" lay-verify="title" id="longitude"
						autocomplete="off" placeholder="请输入经度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">纬度</label>
				<div class="layui-input-block">
					<input type="text" name="latitude" lay-verify="title" id="latitude"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">开门时间</label>
				<div class="layui-input-block">
					<input type="text" name="open" lay-verify="title" id="open"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">关门时间</label>
				<div class="layui-input-block">
					<input type="text" name="colse" lay-verify="title" id="colse"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">平均消费</label>
				<div class="layui-input-block">
					<input type="text" name="ave" lay-verify="title" autocomplete="off"
						placeholder="请输入纬度" class="layui-input phone" id="ave">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">位置</label>
				<div class="layui-input-block">
					<input type="text" name="area" lay-verify="title" id="area"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">邮箱</label>
				<div class="layui-input-block">
					<input type="text" name="email" lay-verify="title" id="email"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone"
						value="无">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">餐厅类型</label>
				<div class="layui-input-block">
					<select name="type" id="type">
						<option value="1">自助餐</option>
						<option value="2">普通餐廳</option>
					</select>

				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">描述</label>
				<div class="layui-input-block">
					<input type="text" name="remark" lay-verify="title" id="remark"
						autocomplete="off" placeholder="请输入纬度" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">主营类型</label>
				<div class="layui-input-block">
					<input type="text" name="btype" lay-verify="title" id="btype"
						autocomplete="off" placeholder="请输入主营类型" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
					<label class="layui-form-label">餐厅状态</label>
				<div class="layui-input-block">
					<select name="state" id="state">
						<option value="1">开业</option>
						<option value="2">停业</option>
					</select>

				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">可否停车</label>
				<div class="layui-input-block">
						<select name="park" id="park">
						<option value="1">可以</option>
						<option value="0">不可以</option>
					</select>
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">餐厅热度</label>
				<div class="layui-input-block">
					<input type="text" name="hot" lay-verify="title" id="hot"
						autocomplete="off" placeholder="请输入热度" class="layui-input phone" maxlength="3">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">餐厅分数</label>
				<div class="layui-input-block">
					<input type="text" name="score" lay-verify="title" id="score"
						autocomplete="off" placeholder="请输入主营类型" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">是否浪漫</label>
				<div class="layui-input-block">
						<select name="romance" id="romance">
						<option value="1">浪漫</option>
						<option value="0">不浪漫</option>
					</select>
			</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">验证码</label>
				<div class="layui-input-block">
					<input type="text" name="verify" lay-verify="title" id="verify"
						autocomplete="off" placeholder="请输入主营类型" class="layui-input phone">
				</div>
			</div>
			<div class="layui-form-item">
				<label class="layui-form-label">图片</label>
				<div class="layui-input-block inputfile">
					点击上传 <input type="file" name="picture" lay-verify="title"
						autocomplete="off" class="layui-input inputfileadd"
						id="FileUpload">
				</div>
				<img class="upimg" name="picture"/>
			</div>
			<!--  <div class="layui-form-item">
					<label class="layui-form-label">红包数</label>
					<div class="layui-input-block">
						<input type="text" name="title" lay-verify="title" autocomplete="off" placeholder="请输入密码" class="layui-input redbagNum">
					</div>
				</div>-->
			<input type="hidden" name="tname" id="tname">
			<input type="hidden" name="sid" id="sid">
			<div class="layui-form-item">
				<button type="button" class="layui-btn" lay-submit lay-filter="c"
					onclick="settijiao()">提交</button>
				<button type="button" class="layui-btn" id="quxiao">取消</button>
			</div>
			<!--<div class="layui-form-item">
					<label class="layui-form-label">上传头像</label>
					<div class="layui-input-block">
						<button type="button" class="layui-btn" id="test1"><i class="layui-icon">&#xe67c;</i>上传头像</button>
					</div>
				</div>-->
			<!--
                
                
				<div class="layui-form-item">
					<label class="layui-form-label">用户描述</label>
					<div class="layui-input-block">
						<textarea type="text" name="title" lay-verify="title" autocomplete="off" placeholder="用户描述" class="layui-input des" style="width: 500px;height: 100px;" disabled="disabled"></textarea>
					</div>
				</div>
-->
		</form>
	</div>

	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script src="js/common.js"></script>
	<script src="layui/layui.js"></script>
	<script src="layer-v3.1.1/layer/mobile/layer.js"></script>
	<script>
			$(function() {
				var sid = getQueryString("sid");
				$("#sid").val(sid);
				$.ajax({
					type: "post",
					url: baseurl + "/dbShop/getshop",
					data: {
						sid: sid
					},
					success: function(data) {
						console.log(data)
						$("#name").val(data.data.sName);
						$("#ename").val(data.data.sEnglishName);
						$("#phone").val(data.data.sPhone);
						$("#longitude").val(data.data.sLongitude);
						$("#latitude").val(data.data.sLatitude);
						$("#open").val(data.data.sOpenTime);
						$("#colse").val(data.data.sCloseTime);
						$("#ave").val(data.data.sAverage);
						$("#area").val(data.data.sArea);
						$("#email").val(data.data.sEmail);
						$("#type").val(data.data.sType);
						$("#remark").val(data.data.sRemark);
						$("#btype").val(data.data.sBusinessType);
						$("#score").val(data.data.sScore);
						$("#state").val(data.data.sState);
						$("#verify").val(data.data.sVerify);
						$("#romance").val(data.data.sRomance);
						$("#park").val(data.data.sPark);
						$("#hot").val(data.data.sHot);
					}
				});
			})

		/*	layui.use(['element', 'layer'], function() {
				var $ = layui.jquery,
					element = layui.element;
				layer = layui.layer;

			});
		var roomId = getQueryString("roomId");
			$.ajax({
				type: "post",
				url: baseurl + "/com/queryRoomLp",
				data: {
					room_id: roomId
				},
				success: function(data) {
					console.log(data)
					$(".roomId").val(data.data.roomId);
					$(".roomName").val(data.data.roomName);
					$(".roomType").val(data.data.roomType);
					$(".roomNum").val(data.data.roomNum);
					$(".redbagNum").val(data.data.redbagNum);
				}
			});
	
			$("#quxiao").click(function() {
				window.parent.location.reload();
			})*/
			var str=""
			$(".inputfileadd").change(function(){
			     
			       var fileObj = document.getElementById("FileUpload").files[0]; // js 获取文件对象
	               if (typeof (fileObj) == "undefined" || fileObj.size <= 0) {
	                 layer.alert('请选择图片'); 
	                   return false;
	               }
	               var formFile = new FormData();
	               formFile.append("files", fileObj); //加入文件对象
	     $.ajax({
	                url:baseurl + "/dbUser/head",  
	                data: formFile,
	                type: "Post",
	                dataType: "json",
	                cache: false,//上传文件无需缓存
	                processData: false,//用于对data参数进行序列化处理 这里必须false
	                contentType: false, //必须
	                success: function (result) {
	                  if (result.meta.code == 200) {
	                	  $(".upimg").css("display","inline-block").attr("src",result.data);
	                	  str=result.data;
		                   layer.alert("上传完成!");
	                  }
	                },
	            })
			   });
	/*		function up(){
				var oMyForm = new FormData();                    // 创建一个空的
				oMyForm.append("File",$("#test1") .files[0]);
				$.ajax({  
				     url : baseurl + "/dbUser/head",  
				     type : "POST",  
				     data:oMyForm,
				     processData:false,   //  告诉jquery不要处理发送的数据
				     contentType:false    // 告诉jquery不要设置content-Type请求头
				     success : function(data) {  

				     }
				});
			}*/
			layui.use(['form','element', 'layer'], function() {
				var $ = layui.jquery,
					element = layui.element;
				var form = layui.form;
				layer = layui.layer;
				var  type=$("type").val();
				if(type==1){
					type="自助餐";
				}else{
					type="普通餐廳";
				}
				$("#tname").val(type);
					form.on('submit(c)', function(data){
						 console.log(data.field) //当前容器的全部表单字段，名值对形式：{name: value}
						 data.field.picture=str;
						 var a=data.field;
						 settijiao(a);
					})
			});
			function settijiao(a){
				$.ajax({
					type: "post",
					url: baseurl + "/dbShop/changeshop",
					data:a,
					success: function(data) {
						console.log(data)
						if(data.meta.code == 200) {
							//alert('修改成功');
							layer.alert('修改成功', function() {
								window.parent.location.reload();
							});
						} else {
							if(data.meta.msg=='失败了！'){
								layer.alert(data.meta.msg);
							}else{
								layer.alert("修改失败");
							}
						}
					}
				})
			}
			//})	
			//			function userlist(username, /* phone, */ address) {
			//
			//				$.ajax({
			//						type: "GET", //提交方式 
			//						url: baseurl + "/com/queryRoomLp", //路径 
			//						dataType: 'json',
			//						data: {
			//							username: username,
			//							/*phone: phone,*/
			//							address: address,
			//							/*userType: userType,
			//							vip: vip,*/
			//						}, //数据，这里使用的是Json格式进行传输 
			//						success: function(data) { //返回数据根据结果进行相应的处理 
			//							consolo.log(data)
			//							console.log(data.data);
			//							list = data.data;
			//							layui.use('table', function() {
			//								var table = layui.table;
			//								//第一个实例
			//								table.render({
			//									elem: '#demo',
			//									id: 'testReload',
			//									data: list, //数据接口
			//									page: true, //开启分页
			//									totalRow: true, //开启合计行
			//									limit: 10,
			//									limits: [10],
			//									cols: [
			//										[{
			//											checkbox: true,
			//											LAY_CHECKED: false,
			//											filter: 'test',
			//											width: 300
			//										}, {
			//											field: 'roomId',
			//											title: 'ID',
			//											width: 250,
			//
			//										}, {
			//											field: 'roomName',
			//											title: '房间名',
			//											width: 250,
			//										}, {
			//											fileld: 'roomType',
			//											title: '房间类型',
			//											width: 201,
			//										}, {
			//											field: 'roomNum',
			//											title: '人数',
			//											width: 250,
			//										}, {
			//											field: 'redbagNum',
			//											title: '红包数',
			//											width: 250,
			//											//											templet: '#barDemo3',
			//										}, {
			//											title: '操作',
			//											width: 270,
			//											toolbar: '#barDemo'
			//
			//										}]
			//									]
			//								});
			//							var layer;
			//							var user_id;
			//							$(function() {
			//								var user_id = getQueryString("user_id");
			//								layui.use(['element', 'layer'], function() {
			//									var $ = layui.jquery,
			//										element = layui.element;
			//									layer = layui.layer;
			//
			//								});
			//								$.ajax({
			//									type: "POST", //提交方式 
			//									url: baseurl + "/user/userlist", //路径 
			//									dataType: 'json',
			//									data: {
			//										userid: user_id,
			//										//user_id: localStorage.getItem("userId"),
			//									}, //数据，这里使用的是Json格式进行传输 
			//									success: function(data) { //返回数据根据结果进行相应的处理 
			//										if(data.meta.code == 200) {
			//											var user = data.data;
			//											if(user.nickname == null || user.nickname.trim().length < 1) {
			//												$(".nickname").val("暂无");
			//											} else {
			//												$(".nickname").val(user.nickname);
			//											}
			//											if(user.password == null || user.password.trim().length < 1) {
			//												$(".password").val("暂无");
			//											} else {
			//												$(".password").val(user.password);
			//											}
			//											if(user.phone == null || user.phone.trim().length < 1) {
			//												$(".phone").val("暂无");
			//											} else {
			//												$(".phone").val(user.phone);
			//											}
			//											//							if(user.userOpenid == null || user.userOpenid.trim().length < 1) {
			//											//								$(".userOpenid").val("暂无");
			//											//							} else {
			//											//								$(".userOpenid").val(user.userOpenid);
			//											//							}
			//											//							if(user.userType == 'read') {
			//											//								$(".userType").val("读者");
			//											//							} else {
			//											//								$(".userType").val("作者");
			//											//							}
			//											//							if(user.VipStatus == 'Y') {
			//											//								$(".VipStatus").val("VIP用户");
			//											//							} else {
			//											//								$(".VipStatus").val("普通用户");
			//											//							}
			//											//							if(user.des == null || user.des.trim().length < 1) {
			//											//								$(".des").val("暂无");
			//											//							} else {
			//											//								$(".des").val(user.des);
			//											//							}
			//
			//										} else {
			//											layer.msg('获取信息失败');
			//										}
			//									}
			//								});
			//							})
			//						})
			//				})
		</script>
</body>

</html>