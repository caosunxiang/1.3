<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<title>编辑文字广告</title>
		<link rel="stylesheet" href="layui/css/layui.css">
		<link rel="stylesheet" href="static/css/style.css">
	</head>

	<body>
		<div class="container">
			<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
				<legend>编辑文字广告</legend>
			</fieldset>

			<form class="layui-form" style="margin-top: 100px;">
				<div class="layui-form-item">
					<div class="layui-inline">
						<label class="layui-form-label">所有作品</label>
						<div class="layui-input-inline">
							<select name="quiz" lay-filter="status" id="xiala">
								<option value=""></option>
							</select>
						</div>
					</div>

				</div>

				<div class="layui-form-item">
					<label class="layui-form-label">文字内容</label>
					<div class="layui-input-block">
						<input type="text" autocomplete="off" placeholder="请输入板块名称" class="layui-input adcontent" style="width: 500px;">
					</div>
				</div>

			</form>
			<div style="margin-left:300px;margin-top: 50px; ">
				<button class="layui-btn layui-btn-lg layui-btn-normal" id="save">保存</button>
			</div>
		</div>
		<script type="text/javascript " src="js/jquery.min.js "></script>
		<script src="js/common.js "></script>
		<script src="layui/layui.js "></script>
		<script src="layer-v3.1.1/layer/mobile/layer.js"></script>
		<script>
			var book_id;
			var form;
			var adid;
			var adcontent;
			$(function() {
				adid = getQueryString("adid");
				console.log(adid);
				layui.use(['element', 'form', "upload"], function() {
					var $ = layui.jquery,
						element = layui.element;
					var upload = layui.upload;
					form = layui.form;

					$.ajax({
						type: "POST", //提交方式 
						url: baseurl + "/book/getBookByPassxuanze", //路径 
						//数据，这里使用的是Json格式进行传输 
						success: function(data) { //返回数据根据结果进行相应的处理 
							list = data.data;
							$.each(data.data, function(index, item) {
								$('#xiala').append(new Option(item.book_name, item.book_id)); // 下拉菜单里添加元素
							})
							form.render(); //下拉菜单渲染 把内容加载进去
							$.ajax({
								url: baseurl + '/com/getAdDinfo',
								dataType: 'json',
								type: 'post',
								data: {
									adid: adid,
								},
								success: function(data) {
									adcontent = data.data.adcontent;
									$(".adcontent").val(data.data.adcontent);
									$('#xiala').find("option[value=" + data.data.book_id + "]").attr("selected", true);
									form.render();

								}
							});
						}
					});

					form.on('select(status)', function(data) {
						console.log(data.elem); //得到select原始DOM对象
						console.log(data.value); //得到被选中的值
						console.log(data.othis); //得到美化后的DOM对象
						book_id = data.value;
					});

				})
				$("#save").click(function() {
					$.ajax({
						url: baseurl + '/com/instAdCharacter',
						dataType: 'json',
						type: 'post',
						data: {
							adcontent: $(".adcontent").val(),
							bookid: book_id,
							type: "adCharacter",
							adid: adid,
						},
						success: function(data) {
							if(data.meta.code == 200) {
								layer.msg('保存成功');
							}

						}
					});
				})
			})
		</script>
	</body>

</html>